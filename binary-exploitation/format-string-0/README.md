# format string 0 (2024)
> Binary Exploitation

### Description
> Can you use your knowledge of format strings to make the customers happy?
> 
> Download the binary [here](https://artifacts.picoctf.net/c_mimas/67/format-string-0).
>
> Download the source [here](https://artifacts.picoctf.net/c_mimas/67/format-string-0.c).
>
> Additional details will be available after launching your challenge instance.
>
> **Hint 1: This is an introduction of format string vulnerabilities. Look up "format specifiers" if you have never seen them before.**
> **Hint 2: Just try out the different options**

### Solution
Starting a challenge instance and interacting with it, we are prompted to serve Patrick a meal. Serving Patrick a meal, we're prompted to serve him another - which we do, then the connection closes.

Taking a look at the binary source, we can see a main function which loads the flag into memory, calls `sigsegv_handler`, calls `serve_patrick`, which in turn calls `serve_bob`. The `on_menu` function is used by both bob and patrick to compare user input to what's on the menu. 

It immediately seems that the format specifier vulnerability (which we know is the case from the description) is from the use of `scanf` and it's inclusion of `%s`, leading to the possibility of a user supplied string being longer than the created buffer. If we supply a proper menu item followed by a long enough string of characters, we can probably overflow the buffer to get the contents of the flag.

Using the following string as input worked immediately:
> Breakf@st_Burgeraaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa


### Flag
`picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}`
